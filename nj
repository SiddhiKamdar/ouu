package com.example.backend.entity;

import jakarta.persistence.*;
import java.util.Date;

@Entity
@Table(name = "travel_details")
public class Travel {

    @Id
    @Column(name = "travel_id")
    private Long travelId;

    @ManyToOne
    @JoinColumn(name = "employee_id")
    private Employee employee;

    @Column(name = "destination")
    private String destination;

    @Column(name = "depart_date")
    private Date departDate;

    @Column(name = "return_date")
    private Date returnDate;

    public Long getTravelId() {
        return travelId;
    }

    public void setTravelId(Long travelId) {
        this.travelId = travelId;
    }

    public Employee getEmployee() {
        return employee;
    }

    public void setEmployee(Employee employee) {
        this.employee = employee;
    }

    public String getDestination() {
        return destination;
    }

    public void setDestination(String destination) {
        this.destination = destination;
    }

    public Date getDepartDate() {
        return departDate;
    }

    public void setDepartDate(Date departDate) {
        this.departDate = departDate;
    }

    public Date getReturnDate() {
        return returnDate;
    }

    public void setReturnDate(Date returnDate) {
        this.returnDate = returnDate;
    }
}

package com.example.backend.entity;

import jakarta.persistence.*;

@Entity
@Table(name = "employees")
public class Employee {

    @Id
    @Column(name = "employee_id")
    private Long employeeId;

    @Column(name = "full_name")
    private String fullName;

    public Long getEmployeeId() {
        return employeeId;
    }

    public void setEmployeeId(Long employeeId) {
        this.employeeId = employeeId;
    }

    public String getFullName() {
        return fullName;
    }

    public void setFullName(String fullName) {
        this.fullName = fullName;
    }
}

package com.example.backend.dto.response;

import java.util.Date;

public class TravelResponseDTO {

    private Long travelId;
    private String fullName;
    private String destination;
    private Date departDate;
    private Date returnDate;

    public TravelResponseDTO(Long travelId, String fullName,
                             String destination, Date departDate,
                             Date returnDate) {
        this.travelId = travelId;
        this.fullName = fullName;
        this.destination = destination;
        this.departDate = departDate;
        this.returnDate = returnDate;
    }

    public Long getTravelId() {
        return travelId;
    }

    public String getFullName() {
        return fullName;
    }

    public String getDestination() {
        return destination;
    }

    public Date getDepartDate() {
        return departDate;
    }

    public Date getReturnDate() {
        return returnDate;
    }
}

package com.example.backend.repository;

import com.example.backend.entity.Travel;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface TravelModuleRepository extends JpaRepository<Travel, Long> {
}

package com.example.backend.service;

import com.example.backend.dto.response.TravelResponseDTO;
import com.example.backend.entity.Travel;
import com.example.backend.repository.TravelModuleRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class TravelModuleService {

    @Autowired
    private TravelModuleRepository travelModuleRepository;

    public List<TravelResponseDTO> getAllTravels() {

        List<Travel> travels = travelModuleRepository.findAll();

        return travels.stream()
                .map(travel -> new TravelResponseDTO(
                        travel.getTravelId(),
                        travel.getEmployee().getFullName(),
                        travel.getDestination(),
                        travel.getDepartDate(),
                        travel.getReturnDate()
                ))
                .toList();
    }
}

package com.example.backend.controller;

import com.example.backend.dto.response.TravelResponseDTO;
import com.example.backend.service.TravelModuleService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/travel")
public class TravelModuleController {

    @Autowired
    private TravelModuleService travelModuleService;

    @GetMapping("/get-all-travels")
    public ResponseEntity<List<TravelResponseDTO>> getAllTravels() {
        return ResponseEntity.ok(travelModuleService.getAllTravels());
    }
}

